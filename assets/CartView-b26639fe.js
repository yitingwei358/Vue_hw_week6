import{_ as I,E as k,r as b,o as i,c,d as e,g as v,F as V,f as C,t as m,a as r,w as P,b as E,h as x,v as w,n as f,i as A}from"./index-9c65c6b8.js";const{VITE_APP_URL:u,VITE_APP_PATH:_}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"j437437",BASE_URL:"/Vue_hw_week6",MODE:"production",DEV:!1,PROD:!0},U={data(){return{products:[],productId:"",cart:{carts:{}},loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{ErrorMessage:k},methods:{getCarts(){const o=`${u}/v2/api/${_}/cart`;this.$http.get(o).then(t=>{this.cart=t.data.data,console.log("取得購物車",t)}).catch(t=>{alert(t.data.message)})},updateCartItem(o){const t=`${u}/v2/api/${_}/cart/${o.id}`,n={product_id:o.product.id,qty:o.qty};this.loadingItem=o.id,this.$http.put(t,{data:n}).then(g=>{this.getCarts(),this.loadingItem="",alert("數量更改成功")}).catch(g=>{alert(g.data.message)})},deleteCartItem(o){const t=`${u}/v2/api/${_}/cart/${o.id}`;this.loadingItem=o.id,this.$http.delete(t).then(n=>{console.log("刪除購物車:",n.data.message),this.getCarts(),this.loadingItem="",alert("刪除成功")}).catch(n=>{alert(n.data.message)})},deleteAllCart(){const o=`${u}/v2/api/${_}/carts`;this.$http.delete(o).then(t=>{alert(t.data.message),this.getCarts()}).catch(t=>{alert(t.data.message)})},isPhone(o){return/^(09)[0-9]{8}$/.test(o)?!0:"請輸入正確的手機號碼"},createOrder(){const o=`${u}/v2/api/${_}/order`,t=this.form;this.$http.post(o,{data:t}).then(n=>{alert(n.data.message),this.$refs.form.resetForm(),t.message="",this.getCarts()}).catch(n=>{alert(n.data.message)})}},mounted(){this.getCarts()}},T=e("h3",null,"前台購物車頁面",-1),q=e("hr",null,null,-1),N={class:"d-flex justify-content-end"},D={key:0,class:"p-2 text-danger fw-bold"},S=["disabled"],B={class:"table align-middle"},L=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),M=["onClick","disabled"],O={key:0,class:"fas fa-spinner fa-pulse"},R={class:"input-group input-group-sm"},j={class:"input-group mb-3"},F=["onUpdate:modelValue","onChange","disabled"],H=["value"],z={class:"text-end"},G=e("td",{colspan:"3",class:"text-end"},"總計",-1),J={class:"text-end"},K=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),Q={class:"text-end text-success"},W={class:"my-5 row justify-content-center"},X={class:"mb-3"},Y=e("label",{for:"email",class:"form-label"},"Email",-1),Z={class:"mb-3"},$=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ee={class:"mb-3"},te=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),se={class:"mb-3"},le=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ae={class:"mb-3"},oe=e("label",{for:"message",class:"form-label"},"留言",-1),ne=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function re(o,t,n,g,s,d){const h=b("v-field"),p=b("error-message"),y=b("v-form");return i(),c(V,null,[T,q,e("div",N,[e("div",null,[s.cart.carts.length===0?(i(),c("p",D," 您還沒加入任何商品呦! 趕快逛逛吧! ")):v("",!0)]),e("div",null,[e("button",{class:"btn btn-outline-danger p-2",type:"button",onClick:t[0]||(t[0]=(...l)=>d.deleteAllCart&&d.deleteAllCart(...l)),disabled:s.cart.carts.length===0}," 清空購物車 ",8,S)])]),e("div",null,[e("table",B,[L,e("tbody",null,[s.cart.carts?(i(!0),c(V,{key:0},C(s.cart.carts,l=>(i(),c("tr",{key:l.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:a=>d.deleteCartItem(l),disabled:l.id===s.loadingItem},[l.id===s.loadingItem?(i(),c("i",O)):v("",!0),E(" x ")],8,M)]),e("td",null,m(l.product.title)+" ",1),e("td",null,[e("div",R,[e("div",j,[x(e("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":a=>l.qty=a,onChange:a=>d.updateCartItem(l),disabled:l.id===s.loadingItem},[(i(),c(V,null,C(20,a=>e("option",{value:a,key:a+"1234"},m(a),9,H)),64))],40,F),[[w,l.qty]])])])]),e("td",z,m(l.total),1)]))),128)):v("",!0)]),e("tfoot",null,[e("tr",null,[G,e("td",J,m(s.cart.total),1)]),e("tr",null,[K,e("td",Q,m(s.cart.final_total),1)])])])]),e("div",W,[r(y,{ref:"form",class:"col-md-6",onSubmit:d.createOrder},{default:P(({errors:l})=>[e("div",X,[Y,r(h,{id:"email",name:"email",type:"email",class:f(["form-control",{"is-invalid":l.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:s.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=a=>s.form.user.email=a)},null,8,["class","modelValue"]),r(p,{name:"email",class:"invalid-feedback"})]),e("div",Z,[$,r(h,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":l.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:s.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=a=>s.form.user.name=a)},null,8,["class","modelValue"]),r(p,{name:"姓名",class:"invalid-feedback"})]),e("div",ee,[te,r(h,{id:"tel",name:"電話",type:"tel",class:f(["form-control",{"is-invalid":l.電話}]),placeholder:"請輸入電話",rules:d.isPhone,modelValue:s.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=a=>s.form.user.tel=a)},null,8,["class","rules","modelValue"]),r(p,{name:"電話",class:"invalid-feedback"})]),e("div",se,[le,r(h,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":l.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:s.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=a=>s.form.user.address=a)},null,8,["class","modelValue"]),r(p,{name:"地址",class:"invalid-feedback"})]),e("div",ae,[oe,x(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=a=>s.form.message=a)},null,512),[[A,s.form.message]])]),ne]),_:1},8,["onSubmit"])])],64)}const ie=I(U,[["render",re]]);export{ie as default};
