import{_ as f,o as r,c as d,d as t,F as _,f as g,g as m,t as c,b as C,h as I,v as b}from"./index-e4587637.js";const{VITE_APP_URL:i,VITE_APP_PATH:h}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"j437437",BASE_URL:"/Vue_hw_week6",MODE:"production",DEV:!1,PROD:!0},v={data(){return{products:[],productId:"",cart:{carts:{}},loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts(){const e=`${i}/v2/api/${h}/cart`;this.$http.get(e).then(s=>{this.cart=s.data.data,console.log("取得購物車",s)}).catch(s=>{alert(s.data.message)})},updateCartItem(e){const s=`${i}/v2/api/${h}/cart/${e.id}`,a={product_id:e.product.id,qty:e.qty};this.loadingItem=e.id,this.$http.put(s,{data:a}).then(u=>{this.getCarts(),this.loadingItem="",alert("數量更改成功")}).catch(u=>{alert(u.data.message)})},deleteCartItem(e){const s=`${i}/v2/api/${h}/cart/${e.id}`;this.loadingItem=e.id,this.$http.delete(s).then(a=>{console.log("刪除購物車:",a.data.message),this.getCarts(),this.loadingItem="",alert("刪除成功")}).catch(a=>{alert(a.data.message)})},deleteAllCart(){const e=`${i}/v2/api/${h}/carts`;this.$http.delete(e).then(s=>{alert(s.data.message),this.getCarts()}).catch(s=>{alert(s.data.message)})},isPhone(e){return/^(09)[0-9]{8}$/.test(e)?!0:"請輸入正確的手機號碼"},createOrder(){const e=`${i}/v2/api/${h}/order`,s=this.form;this.$http.post(e,{data:s}).then(a=>{alert(a.data.message),this.$refs.form.resetForm(),this.getCarts()}).catch(a=>{alert(a.data.message)})}},mounted(){this.getCarts()}},$=t("h3",null,"前台購物車頁面",-1),x=t("hr",null,null,-1),y={class:"table align-middle"},P=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),V=["onClick","disabled"],k={key:0,class:"fas fa-spinner fa-pulse"},A={class:"input-group input-group-sm"},E={class:"input-group mb-3"},T=["onUpdate:modelValue","onChange","disabled"],w=["value"],D={class:"text-end"},N=t("td",{colspan:"3",class:"text-end"},"總計",-1),U={class:"text-end"},q=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),B={class:"text-end text-success"};function L(e,s,a,u,l,p){return r(),d(_,null,[$,x,t("div",null,[t("table",y,[P,t("tbody",null,[l.cart.carts?(r(!0),d(_,{key:0},g(l.cart.carts,o=>(r(),d("tr",{key:o.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:n=>p.deleteCartItem(o),disabled:o.id===l.loadingItem},[o.id===l.loadingItem?(r(),d("i",k)):m("",!0),C(" x ")],8,V)]),t("td",null,c(o.product.title)+" ",1),t("td",null,[t("div",A,[t("div",E,[I(t("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":n=>o.qty=n,onChange:n=>p.updateCartItem(o),disabled:o.id===l.loadingItem},[(r(),d(_,null,g(20,n=>t("option",{value:n,key:n+"1234"},c(n),9,w)),64))],40,T),[[b,o.qty]])])])]),t("td",D,c(o.total),1)]))),128)):m("",!0)]),t("tfoot",null,[t("tr",null,[N,t("td",U,c(l.cart.total),1)]),t("tr",null,[q,t("td",B,c(l.cart.final_total),1)])])])])],64)}const F=f(v,[["render",L]]);export{F as default};
